(function(b){var g={stopQuiz:function(e){if(superContainer.data().quizEnded)return!0;endTime=b.now();spentTime=Math.round((endTime-startTime)/1E3);spentTimeMin=Math.floor(spentTime/60);spentTimeSec=spentTime-60*spentTimeMin;var f=[];superContainer.find("ul.answers").each(function(a){var c=[];r=1;b(this).children("li").each(function(){b(this).hasClass("selected")&&c.push(r);r++});f.push(b(this).attr("id"));userAnswers.push(c)});var a=[];for(r=0;r<userAnswers.length;r++)a.push('{"questionNumber":"'+
parseInt(f[r])+'", "userAnswers":"'+userAnswers[r]+'"}');res="["+a.join(",")+"]";countdown.timeTo("stop");progressKeeper.hide();notice.hide();notice_multi.hide();for(var c=checkAnswers(),h=a="",g=0,d=0,l=c.length;d<l;d++){!0===c[d]&&g++;h=!0===c[d]?"<div class='correct'><span>\u0412\u0435\u0440\u043d\u043e</span></div>":!1===c[d]?"<div class='wrong'><span>\u041d\u0435\u0432\u0435\u0440\u043d\u043e</span></div>":"<div class='unanswered'><span>\u0411\u0435\u0437 \u043e\u0442\u0432\u0435\u0442\u0430</span></div>";
a+='<div class="result-row"> \u0412\u043e\u043f\u0440\u043e\u0441 \u2116'+(d+1)+h;a+='<div class="resultsview-qhover">'+quizConfig.questions[d].question;a+="<ul>";for(answersIteratorIndex=0;answersIteratorIndex<quizConfig.questions[d].answers.length;answersIteratorIndex++){var k=h="";quizConfig.showCorrectAnswers&&-1!==b.inArray(answersIteratorIndex+1,quizConfig.questions[d].ca)&&(h+="right");-1!==b.inArray(answersIteratorIndex+1,userAnswers[d])&&(k+=" selected-point");a+='<li class="'+h+'"><span class="'+
k+'"></span>'+quizConfig.questions[d].answers[answersIteratorIndex]+"</li>"}a+="</ul></div></div>"}a+='<div class="jquizzy-clear"></div><div class="legend"> ';quizConfig.showCorrectAnswers&&(a+='<span class="right-point"> - \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442</span>, ');a+='<span class="selected-point"> - \u0412\u044b\u0431\u043e\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f </span> </div>';c=roundReloaded(g/
questionLength*100,2);null!==quizConfig.sendResultsURL&&(console.log("\u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0442\u0435\u0441\u0442\u0430"),b.ajax({type:"POST",url:quizConfig.sendResultsURL,data:{task:"save_result",cause:e,ticket:b("#ticket").val(),dossier_id:b("#dossier_id").val(),trial:b("#trial").val(),answers:res,percentage:c,begined:startTime,ended:endTime}}).done(function(a){message=
'<div class="ui-state-highlight ui-corner-all" id="message">';message+='<p><span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span>';message+="<strong>"+a+"</strong><br /></p></div>";b(message).appendTo(".message")}));a='<h2 class="qTitle">'+e+"<br/> \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: "+judgeSkills(c)+", \u0412\u044b \u043d\u0430\u0431\u0440\u0430\u043b\u0438 "+c+"%, \u0437\u0430\u0442\u0440\u0430\u0447\u0435\u043d\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 "+
spentTimeMin+" \u043c\u0438\u043d.</h2> "+a+'<div class="jquizzy-clear"/>';superContainer.find(".result-keeper").html(a).show(500);superContainer.find(".resultsview-qhover").hide();superContainer.find(".result-row").hover(function(){b(this).find(".resultsview-qhover").show()},function(){b(this).find(".resultsview-qhover").hide()});superContainer.find(".slide-container").hide(function(){superContainer.find(".results-container").fadeIn(500)});b("#"+quizConfig.closePageButtonId).toolbar("showButton");
b("#"+quizConfig.cancelTestButtonId).toolbar("hideButton");superContainer.data("quizEnded",1);return!0},saveResults:function(){}};b.fn.quiz=function(e){var f={};if(g[e])return g[e].apply(this,Array.prototype.slice.call(arguments,1));"object"!==typeof e&&e?b.error("\u041c\u0435\u0442\u043e\u0434 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c "+e+" \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0434\u043b\u044f jQuery.quiz"):f=e;quizConfig=b.extend({questions:null,startText:"\u041d\u0430\u0447\u0430\u043b\u043e \u0442\u0435\u0441\u0442\u0430",
endText:"\u0422\u0435\u0441\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d",splashImage:"includes/style/images/play-icon.png",sendResultsURL:"quiz_helper.php",timeToTest:3600,hostip:"172.16.172.33",showCorrectAnswers:!0,closePageButtonId:"close_quizpage",cancelTestButtonId:"cancel_quiz",resultComments:{perfect:"\u0417\u0430\u043c\u0435\u0447\u0430\u0442\u0435\u043b\u044c\u043d\u043e! (\u043e\u0446\u0435\u043d\u043a\u0430 - 5)",excellent:"\u041e\u0446\u0435\u043d\u043a\u0430 - 5",good:"\u0425\u043e\u0440\u043e\u0448\u043e! (\u043e\u0446\u0435\u043d\u043a\u0430 - 4)",
average:"\u041f\u0440\u0438\u0435\u043c\u043b\u0435\u043c\u043e! (\u043e\u0446\u0435\u043d\u043a\u0430 - 3)",bad:"\u041d\u0435\u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e! (\u043e\u0446\u0435\u043d\u043a\u0430 - 2)",poor:"\u041e\u0446\u0435\u043d\u043a\u0430 - 1",worst:"\u041e\u0446\u0435\u043d\u043a\u0430 - 1"}},f);if(window.location.host!=quizConfig.hostip)console.log("\u0425\u043e\u0441\u0442 "+window.location.host),b(this).html('<div class="intro-container slide-container"><h2 class="qTitle">\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 (1)</h2></div>');
else if(null===quizConfig.questions)b(this).html('<div class="intro-container slide-container"><h2 class="qTitle">\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0438 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 (2)</h2></div>');else if(0===quizConfig.questions.length)b(this).html('<div class="intro-container slide-container"><h2 class="qTitle">\u041d\u0435\u0442 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u0442\u0435\u043c\u0435</h2></div>');
else{superContainer=this;answers=[];introFob='<div class="intro-container slide-container"><div class="question-number">'+quizConfig.startText+'</div><a class="nav-start" href="#"><img src="'+quizConfig.splashImage+'" /></a></div>';exitFob='<div class="results-container slide-container"><div class="question-number">'+quizConfig.endText+'</div><div class="result-keeper"></div></div>';exitFob+='<div class="notice">\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043e\u0442\u0432\u0435\u0442\u0430</div><div class="notice_multi">\u0414\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u0430 \u043d\u0443\u0436\u043d\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0431\u043e\u043b\u0435\u0435 \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0442\u0432\u0435\u0442\u0430</div>';
exitFob+='<div class="progress-keeper" ><div class="progress"></div></div>';endTime=startTime=contentFob="";countdown=b("#countdown");superContainer.addClass("main-quiz-holder");qType=function(a){return 1==a?"\u0412\u044b\u0431\u043e\u0440":2==a?"\u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0432\u0435\u0442\u043e\u0432":"\u0422\u0438\u043f \u0432\u043e\u043f\u0440\u043e\u0441\u0430 \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d"};if(window.location.host==
quizConfig.hostip){for(questionsIteratorIndex=0;questionsIteratorIndex<quizConfig.questions.length;questionsIteratorIndex++){contentFob+='<div class="slide-container">';contentFob+='<div class="question-type">\u0422\u0438\u043f \u0432\u043e\u043f\u0440\u043e\u0441\u0430: "'+qType(quizConfig.questions[questionsIteratorIndex].qT)+'"</div>';contentFob+='<div class="question-number">'+(questionsIteratorIndex+1)+"/"+quizConfig.questions.length+"</div>";contentFob+='<div class="question"></div>';contentFob+=
'<ul id="'+quizConfig.questions[questionsIteratorIndex].qId+'" class="answers">';for(answersIteratorIndex=0;answersIteratorIndex<quizConfig.questions[questionsIteratorIndex].answers.length;answersIteratorIndex++)contentFob+="<li>"+quizConfig.questions[questionsIteratorIndex].answers[answersIteratorIndex]+"</li>";contentFob+="</ul>";contentFob+='<div class="nav-container">';0!==questionsIteratorIndex&&(contentFob+='<div class="prev"><a class="nav-previous" href="#">\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439</a></div>');
contentFob=questionsIteratorIndex<quizConfig.questions.length-1?contentFob+'<div class="next"><a class="nav-next" href="#">\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439</a></div>':contentFob+'<div class="next final"><a class="nav-show-result" href="#">\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435</a></div>';contentFob+="</div></div>";answers.push(quizConfig.questions[questionsIteratorIndex].ca)}superContainer.html(introFob+contentFob+exitFob);f=[];for(r=0;r<quizConfig.questions.length;r++)f.push(quizConfig.questions[r].qId);
q_ids="["+f.join(",")+"]";b.ajax({type:"POST",url:quizConfig.sendResultsURL,data:{task:"get_question",ids:q_ids}}).done(function(a){t=b.parseJSON(a);r=0;superContainer.find(".question").each(function(){b(this).text(t[r]);quizConfig.questions[r].question=t[r];r++})});progress=superContainer.find(".progress");progressKeeper=superContainer.find(".progress-keeper");notice=superContainer.find(".notice");notice_multi=superContainer.find(".notice_multi");progressWidth=progressKeeper.width();userAnswers=
[];questionLength=quizConfig.questions.length;slidesList=superContainer.find(".slide-container");progressKeeper.hide();notice.hide();notice_multi.hide();slidesList.hide().first().fadeIn(500)}countdown.timeTo(quizConfig.timeToTest,function(){g.stopQuiz(" \u0412\u0440\u0435\u043c\u044f \u043e\u0442\u0432\u0435\u0434\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u043e\u0442\u0432\u0435\u0442\u044b \u0438\u0441\u0447\u0435\u0440\u043f\u0430\u043d\u043e. ")});checkAnswers=function(){var a=[],b=!1;for(i=
0;i<answers.length;i++)b=answers[i].toString()==userAnswers[i].toString()?!0:!1,""==userAnswers[i].toString()&&(b=null),a.push(b);return a};roundReloaded=function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)};judgeSkills=function(a){return 90<=a?quizConfig.resultComments.excellent:80<=a?quizConfig.resultComments.good:70<=a?quizConfig.resultComments.average:50<=a?quizConfig.resultComments.bad:quizConfig.resultComments.poor};superContainer.find("li").click(function(){var a=b(this);'\u0422\u0438\u043f \u0432\u043e\u043f\u0440\u043e\u0441\u0430: "\u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0432\u0435\u0442\u043e\u0432"'==
a.parents(".slide-container").find(".question-type").html()?a.hasClass("selected")?a.removeClass("selected"):a.addClass("selected"):a.hasClass("selected")?a.removeClass("selected"):(a.parents(".answers").children("li").removeClass("selected"),a.addClass("selected"))});superContainer.find(".nav-start").click(function(){b(this).parents(".slide-container").fadeOut(500,function(){b(this).next().fadeIn(500);progressKeeper.fadeIn(500)});startTime=b.now();countdown.timeTo("start",quizConfig.timeToTest);
return!1});superContainer.find(".next").click(function(){notice.hide();notice_multi.hide();var a=!1;'\u0422\u0438\u043f \u0432\u043e\u043f\u0440\u043e\u0441\u0430: "\u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0432\u0435\u0442\u043e\u0432"'===b(this).parents(".slide-container").find("div.question-type").text()&&(a=!0);if(0===b(this).parents(".slide-container").find("li.selected").length)return notice.fadeIn(300),!1;notice.hide();if(1===b(this).parents(".slide-container").find("li.selected").length&&
a)return notice_multi.fadeIn(300),!1;notice_multi.hide();b(this).parents(".slide-container").fadeOut(500,function(){b(this).next().fadeIn(500)});progress.animate({width:progress.width()+Math.round(progressWidth/questionLength)},500);return!1});superContainer.find(".prev").click(function(){notice.hide();b(this).parents(".slide-container").fadeOut(500,function(){b(this).prev().fadeIn(500)});progress.animate({width:progress.width()-Math.round(progressWidth/questionLength)},500);return!1});superContainer.find(".final").click(function(){if(0===
b(this).parents(".slide-container").find("li.selected").length)return notice.fadeIn(300),!1;countdown.timeTo("stop");g.stopQuiz(" \u0412\u0441\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u044b. ")})}}})(jQuery);